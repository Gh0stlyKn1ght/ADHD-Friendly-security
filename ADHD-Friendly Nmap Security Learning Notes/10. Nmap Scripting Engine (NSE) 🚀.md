### **ADHD-Friendly Notes: Nmap Scripting Engine (NSE)** ğŸš€

## **ğŸ“Œ Why Use NSE?**

âœ… Automates scanning & exploitation ğŸ”„  
âœ… Runs **pre-built scripts** to detect **services, vulnerabilities, and exploits** ğŸ”  
âœ… Uses **Lua scripting** for advanced network scanning ğŸ§‘â€ğŸ’»

---

## **ğŸ›  NSE Categories & Usage**

|**Category**|**Description**|
|---|---|
|**auth**|Detects authentication credentials ğŸ”‘|
|**brute**|Runs **brute-force login** attacks ğŸ”“|
|**default**|Runs **basic scripts** (`-sC` option)|
|**discovery**|Gathers **service & network info** ğŸ•µï¸â€â™‚ï¸|
|**vuln**|Checks for **known vulnerabilities** âš ï¸|
|**exploit**|Attempts to **exploit** known weaknesses ğŸ’¥|
|**version**|Enhances **service detection**|

ğŸ”— **Full List of NSE Scripts:** [Nmap NSE Documentation](https://nmap.org/nsedoc/index.html)

---

## **ğŸ” Running NSE Scripts**

### **1ï¸âƒ£ Run Default Scripts**

```bash
sudo nmap <target-IP> -sC
```

ğŸ“Œ **Runs all scripts in the `default` category** (basic checks).

---

### **2ï¸âƒ£ Run a Specific Category**

```bash
sudo nmap <target-IP> --script <category>
```

ğŸ“Œ **Example:**

```bash
sudo nmap <target-IP> --script vuln
```

âœ… **Runs all scripts in the `vuln` category** (finds known vulnerabilities).

---

### **3ï¸âƒ£ Run Specific Scripts**

```bash
sudo nmap <target-IP> --script <script-name>,<script-name>
```

ğŸ“Œ **Example: Check SMTP Server Details**

```bash
sudo nmap <target-IP> -p 25 --script banner,smtp-commands
```

âœ… **Finds service banners & supported SMTP commands**

ğŸ“Œ **Example Output:**

```
PORT   STATE SERVICE
25/tcp open  smtp
|_banner: 220 inlane ESMTP Postfix (Ubuntu)
|_smtp-commands: PIPELINING, VRFY, STARTTLS, DSN
```

---

## **ğŸ”¥ Aggressive Scan (`-A`)**

```bash
sudo nmap <target-IP> -p 80 -A
```

ğŸ“Œ **What does `-A` do?**

- **Service detection (`-sV`)**
- **OS detection (`-O`)**
- **Traceroute (`--traceroute`)**
- **Runs default scripts (`-sC`)**

âœ… **Example Output:**

```
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache 2.4.29 (Ubuntu)
|_http-title: blog.inlanefreight.com
|_http-generator: WordPress 5.3.4
```

ğŸ”¥ **Finds the CMS, OS, and webserver details**
---

## **ğŸš€ Vulnerability Assessment**

```bash
sudo nmap <target-IP> -p 80 -sV --script vuln
```

ğŸ“Œ **Finds vulnerabilities based on detected versions**
âœ… **Example Output:**

```
| http-wordpress-users:
| Username found: admin
| vulners:
|   Apache 2.4.29:
|      CVE-2019-0211 - 7.2 [https://vulners.com/cve/CVE-2019-0211]
|      CVE-2018-1312 - 6.8 [https://vulners.com/cve/CVE-2018-1312]
```

ğŸ”¥ **Finds exploits for Apache & WordPress versions**

---

## **ğŸ¯ Key Takeaways**

âœ… **NSE automates scanning, discovery, and exploitation**  
âœ… Use `-sC` for **default scripts**, `-A` for **aggressive scans**  
âœ… Use `--script vuln` to **find security vulnerabilities**  
âœ… Combine **specific scripts** for **targeted enumeration**

ğŸš€ **Master NSE to speed up recon & vulnerability scanning!** ğŸ”¥

---

### **1ï¸âƒ£ Perform a Full Port & Service Scan with NSE**

Run a **service detection scan with default scripts**:

```bash
sudo nmap <target-IP> -p- -sV -sC
```

ğŸ“Œ **Why?**

- `-p-` â†’ Scans **all ports** (1-65535)
- `-sV` â†’ Detects **service versions**
- `-sC` â†’ Runs **default NSE scripts**

âœ… **Check the output for any suspicious data that may contain the flag!**

---

### **2ï¸âƒ£ Search for Banner Grabbing & Hidden Data**

Some services may expose the **flag in banners**:

```bash
sudo nmap <target-IP> -p- --script banner
```

ğŸ“Œ **Why?**

- Extracts **service banners**, which sometimes contain **flags or hints**

âœ… **Check SMTP, FTP, HTTP, and SSH services for any readable flags!**

---

### **3ï¸âƒ£ Scan for Vulnerabilities**

```bash
sudo nmap <target-IP> -p- --script vuln
```

ğŸ“Œ **Why?**

- Checks for **known vulnerabilities** that might **expose sensitive data**

âœ… **Look for web-based exploits, misconfigurations, or open file directories!**

---

### **4ï¸âƒ£ Check for Hidden Files on Web Servers**

If **port 80 or 443 (HTTP/HTTPS) is open**, look for hidden files:

```bash
sudo nmap <target-IP> -p 80 --script http-enum
```

ğŸ“Œ **Why?**

- Lists **potentially exposed directories**
- May find a `/flag.txt` or `/hidden_flag` file

âœ… **If WordPress is detected, try this:**

```bash
sudo nmap <target-IP> -p 80 --script http-wordpress-users
```

---

### **5ï¸âƒ£ Test for SMB Shares (if port 445 is open)**

```bash
sudo nmap <target-IP> -p 445 --script smb-enum-shares,smb-enum-users
```

ğŸ“Œ **Why?**

- SMB may have **open shares** that **contain the flag**

âœ… **If an open share is found, access it manually:**

```bash
smbclient -L //<target-IP>/sharename
```

Then:

```bash
smbclient //<target-IP>/sharename -N
ls
```







