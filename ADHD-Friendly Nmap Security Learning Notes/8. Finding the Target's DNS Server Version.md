### **ğŸ” Finding the Target's DNS Server Version**

To determine the **DNS server version** of the target system, follow these steps:

---

## **Step 1: Perform a Targeted Service Scan on Port 53 (DNS)**

Run an **Nmap version scan (`-sV`)** specifically on **port 53**:

```bash
sudo nmap <target-IP> -p 53 -sV --script=dns-version -Pn -T2
```

ğŸ“Œ **Why?**  
âœ… **`-p 53`** â†’ Targets **DNS service**  
âœ… **`-sV`** â†’ Identifies **service versions**  
âœ… **`--script=dns-version`** â†’ Uses **NSE script** to extract **DNS version**  
âœ… **`-Pn`** â†’ Avoids ping detection (bypasses some firewalls)  
âœ… **`-T2`** â†’ Reduces scan speed to avoid IDS alerts

---

## **Step 2: If the Above Fails, Use a Direct Query**

Some DNS servers expose their version in **TXT queries**:

```bash
dig CHAOS TXT version.bind @<target-IP>
```

ğŸ“Œ **Why?**  
âœ… Some **DNS servers (like BIND)** store version info in `version.bind`

If the target **returns** a version (e.g., `BIND 9.11.3`), thatâ€™s your answer!

---

## **Step 3: Verify Using Netcat**

If **Nmap and `dig` fail**, try a **manual DNS query** with **Netcat**:

```bash
echo -e "\x07version\x04bind\x00\x00\x10\x00\x03" | nc -u -v <target-IP> 53
```

ğŸ“Œ **Why?**  
âœ… **Sends a raw query** asking for `version.bind`  
âœ… **If DNS allows it**, it will **return the version**

---

## **Step 4: Submit the DNS Server Version**

âœ… **If the scan detects:**

- `BIND 9.16.20` â†’ **Submit `BIND 9.16.20`**
- `Microsoft DNS 10.0.17763` â†’ **Submit `Microsoft DNS 10.0.17763`**
- `PowerDNS 4.5.3` â†’ **Submit `PowerDNS 4.5.3`**


## **ğŸ›  Alternative Methods to Find DNS Server Version**

### **ğŸ”¹ 1. Check Installed Nmap Scripts**

Run:

```bash
ls /usr/share/nmap/scripts | grep dns
```

ğŸ“Œ **This lists all available DNS scripts**. If `dns-version` is missing, we need another approach.

---

### **ğŸ”¹ 2. Use `dns-nsid` NSE Script**

Try running:

```bash
sudo nmap <target-IP> -p 53 -sV --script=dns-nsid -Pn
```

ğŸ“Œ **Why?**  
âœ… `dns-nsid` can **extract DNS server version info**  
âœ… Works even if `dns-version` script is missing

---

### **ğŸ”¹ 3. Use `dig` to Query the DNS Version**

If the target runs **BIND**, it might reveal its version:

```bash
dig CHAOS TXT version.bind @<target-IP>
```

ğŸ“Œ **If successful**, youâ€™ll get something like:

```
;; ANSWER SECTION:
version.bind.  0  CH  TXT  "BIND 9.16.20"
```

âœ… **Submit `BIND 9.16.20` as the answer**

---

### **ğŸ”¹ 4. Use `nslookup` to Query the DNS Server**

Try:

```bash
nslookup -type=TXT version.bind <target-IP>
```

ğŸ“Œ Works **if DNS allows version queries**

---

### **ğŸ”¹ 5. Use `nmap -sV` on Port 53**

If all else fails:

```bash
sudo nmap <target-IP> -p 53 -sV -Pn
```

ğŸ“Œ **Look for service details** in the output.

---

### **ğŸ¯ Key Takeaways**

âœ… **Check if NSE scripts exist (`ls /usr/share/nmap/scripts`)**  
âœ… **Use `dns-nsid` instead of `dns-version`**  
âœ… **Try `dig` or `nslookup` for version info**  
âœ… **Run `nmap -sV` if everything else fails**

